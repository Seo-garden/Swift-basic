# iOS 앱의 구조와 코코아 터치 프레임워크

### 2.1.1 엔트리 포인트와 앱의 초기화 과정

UIApplicationMain() 함수는 그 중에서도 iOS 앱에 속하는 부부능 엔트리 포인트이다. 앱의 핵심객체를 생성하는 프로세스를 핸들링하고, 스토리보드 파일로부터 앱의 유저 인터페이스를 잃어 들일뿐만 아니라 우리가 작성한 커스텀 코드를 호출해줌으로써 앱 생성 초기에 필요한 설정을 구현할 수 있게 해준다. 여기에 더해서 이벤트를 입력받기 위한 이벤트 루프를 실행시키기도 한다. 

UIApplication 객체의 역할은 매우 다양하다. 이벤트 루프나 다른 높은 수준의 앱 동작을 관리할 뿐만 아니라 푸시 알림과 같은 특수한 이벤트를 우리가 정의한 커스텀 객체인 델리게이트에게 알려주기도 한다. 

AppDelegate 는 UIApplication으로부터 위임받은 일부 권한을 이용하여 커스텀 코드와 상호작용하는 역할을 담당하고, 이를 통해 우리가 필요한 코드를 구현할 수 있도록 도와준다.

 ### 2.1.2 MVC 패턴
 
 MVC 패턴이란, 소스 코드 설계 기법으로써 Model-View-Controller 이어지는 세 개의 핵심 구조를 이용하여 애플리케이션을 설계하는 것을 말한다. 모델은 데이터를 담당, 뷰는 데이터에 대한 화면 표현을 담당, 컨트롤러는 모델과 뷰 사이에 위치하여 데이터를 가공하여 뷰로 전달하고 뷰에서 발생하는 이벤트를 입력받아 처리하는 역할.
 
 이 패턴을 따르면 데이터 관리 부분을 수정해도 비즈니스로직이나 화면 표현 코드에는 영향을 미치지 않고, 화면을 표현하는 코드를 수정하더라도 비즈니스 로직이나 데이터 관리 부분에 영향을 미치지 않으므로 훨씬 더 프로그램이 유연해지는 결과를 얻을 수 있다.
 
 ### 2.1.3 앱의 상태 변화
 
Not Running : 앱이 시작되지 않았거나 실행되었지만 시스템에 의해 종료된 상태를 나타낸다.

Inactive : 앱이 전면에서 실행중이지만, 아무런 이벤트를 받지 않고 있는 상태.
 
Active : 앱이 전면에서 실행중이며, 이벤트를 받고 있는 상태를 나타냄
 
Background : 앱이 백그라운드에 있지만 여전히 코드가 실행되고 있는 상태를 나타냅니다. 대부분의 Suspended 상태로 이행하는 도중에 일시적으로 이 상태에 진입하지만, 파일 다운로드나 업로드, 연산 처리 등 여분의 실행 시간이 필요한 앱일 경우 특정 시간 동안 이 상태로 남아 있게 되는 경우도 있다.

Suspended : 앱이 메모리에 유지되지만 실행되는 코드가 없는 상태이다. 메모리가 부족한 상황이 오면 iOS 시스템은 포그라운드에 있는 앱의 여유 메모리 공간을 확보하기 위해 Suspended 상태에 있는 앱들을 특별한 알림 없이 정리한다.

앱 델리게이트 객체에는 다양한 메소드들이 정의되어 있으며, 각 메소드들은 모드 그에 맞는 상태 변화에 따라 호출된다. 다음은 주요 메소드들이다.

application(_: willFinishLaunchingWithOptions:) : 앱이 구동되어 필요한 초기 실행 과정이 완료되기 직전에 호출되는 메소드

application(_: didFinishLaunchingWithOptions:) : 앱이 사용자에게 화면으로 표시되기 직전에 호출되는 메소드. 앱이 실행된 후에 진행할 커스터마이징이나 초기화를 위한 코드를 여기에 작성

applicationDidBecomeActive(_:) : 실행된 앱이 포그라운드, 즉 화면 전면에 표시될 때 호출되는 메소드이다. 앱이 Inactive 상태에 들어가면서 일시 중지된 작업이 있다면 이를 재시작하는 코드를 여기에 작성해 주어야 한다. 

applicationDidEnterBackground(_:) : 앱이 백그라운드 상태에 진입했을 때 호출된다. 이 메소드가 호출된다는 것은 미래의 어느 순간에 앱이 종료된다는 의미로, 잃어서는 안 되는 사용자 데이터를 종료 전에 미리 저장하거나, 공유 자원을 점유하고 있었다면 이를 해제해주어야 한다. 종료된 앱이 다시 실행될 때 현재의 상태를 복구할 수 있도록 필요한 상태 정보도 이 메소드에서 저장 처리하는 것이 좋다.

applicationWillTerminate(_:) : 앱이 종료되기 직전에 호출되는 메소드. 사용자 데이터 등을 종료되기 전에 한 번 더 저장해두는 것이 좋다.

### 2.2 iOS와 코코아 터치 프레임워크

하나의 앱을 만들기 위해 필요한 프레임워크는 UIKit 만이 아니다. 네트워크나 연산 날짜 등의 기능 처리를 위해서 파운데이션, 애니메이션 처리를 위해서는 코어 애니메이션, 웹과 관련된 기술을 구현하기 위해서는 웹킷, 주소록 화면 관련 기능을 구현하기 위해서는 AddressBookUI, 사용자 알림을 위해서는 UserNotifications 

    import Foundation       // 파운데이션 프레임워크
    import WebKit           // 웹킷 프레임워크
    import AddressBookUI    // 주소록 UI프레임워크
    import UserNotifications// 사용자 알림 프레임워크

앱을 만들고 실행할 때 필요한 iOS 기반 기술들은 모두 코코아 터치 프레임워크를 통해 구현되기 때문에, 앱을 제작하기 위해서는 결국 코코아 터치 프레임워크 전체를 이해해야 한다.

### 2.2.1 iOS

네이티브 앱은 iOS 시스템 프레임워크를 기반으로 하고 스위프트 언어로 개발되며 iOS 를 통해 직접 실행되는 앱을 말한다. 비교되는 개념으로 웹 앱이 있다. 

### 2.2.2 코코아 터치 프레임워크

코코아 터치 프레임워크는 애플 환경에서 터치 기반의 애플리케이션을 제작하기 위한 도구모음이다. 다음은 코코아 터치 프레임워크를 이루는 주요 프레임워크이다.

    Foundation : 애플리케이션의 핵심 개체와 네트워크, 문자열 처리 등의 서비스를 제공하는 프레임워크
    UIKit : 아이폰이나, 아이패드, 애플워치나 애플TV 등에서 실행되는 애플리케이션의 UI를 제공하는 프레임워크
    iAd : 앱 내의 배너 형태 또는 팝업 형태의 광고를 삽입할 수 있도록 해 주는 광고 관련 프레임워크
    MapKit : 위치 정보나 지도 관련 서비스를 이용할 수 있도록 해주는 프레임워크
    Address Book UI : 번들 애플리케이션으로 제공되는 주소록 앱의 인터페이스와 기능을 커스텀 앱 내에서도 그대로 사용할 수 있도록 해주는 프레임워크
    EventKit UI : 이벤트 처리에 필요한 UI 를 제공하는 프레임워크
    Message UI : 이벤트 처리에 필요한 유저 인터페이스를 제공하는 프레임워크
    UserNotifications : 사용자 알림을 처리하기 위해 필요한 객체들을 제공하는 프레임워크
    WebKit : 웹 관련 기능을 구현하기 위해 필요한 객체들을 제공하는 프레임워크
    
파운데이션 프레임워크는 기본 데이터 형식, 컬렉션 및 앱의 기본 객체와 기반 기술을 제공하는 역할을 하며, UIKit 프레임워크는 UI 도구를 통해 iOS 앱을 구현할 수 있는 방법을 제공한다. 쉽게 생각해서 iOS 앱으로서의 특징적인 부분은 UIKit 프레임워크가, 내부적으로 돌아가는 기능은 Foundation 프레임워크가 처리한다고 보면 된다. 
